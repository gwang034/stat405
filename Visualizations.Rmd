---
title: "Visualizations"
author: "Virginia Baskin, Siddhi Narayan, Grace Wang"
date: "2/19/2023"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Read in dataset
```{r}
library(readr)
tx_houston <- read_csv("/Users/virginiabaskin/Downloads/tx_houston_2023_01_26.csv")
head(tx_houston)
```

### Created smaller dataset to work with initially.

Our computers were struggling to work with the entire dataset, so we created a mini dataset by randomly sampling 1,000 rows. We will use this dataset for creating the graphs/brainstorming, then we will run the code on the large dataset as a final step. 
```{r}
mini_htx <- read_csv("Datasets/mini_htx.csv")
mini_htx
colSums(is.na(mini_htx))
```

## Visualizations 

```{r Race Line Graph by Year}
# visualize totals for each race
# Grace


```

```{r Race to Citation Ratio (Paired Bar Graph)}
# x axis: race
# y axis: Count
# two bars per race for citation issued true and citation issued false
# visualize to investigate for evidence of racial bias
# Siddhi
counts <- table(mini_htx$citation_issued, mini_htx$subject_race)
counts <- na.omit(counts)
barplot(counts/sum(counts), main = "% Citation by Race", xlab = "Race", ylab = "Percent", col = "blue",)
```
Now we will look at the Citation Count by Race. As we can see, white individuals have the highest percentage of citations, followed by black individuals, unknown races, and finally, Asian/pacific individuals. This is somewhat proportional to the actual demographics of Houston (according to the U.S. census) – the White and Black percentages of citations are slightly higher than their population in Houston, while the proportion of citations gotten by Asian individuals is slightly lower than the proportion of Asian people in Houston.


```{r Line graph of number of citations}
# Observe arrests over time and any time-associate patterns
# Siddhi
time <- as.POSIXct(mini_htx$time, format = "%H:%M:%S")
hour <- as.numeric(format(time, "%H"))
count <- data.frame(table(na.omit(hour)))
plot(count$Var1, count$Freq, type = "n", xlab = "Hour", ylab = "Frequency of Arrests", main = "Frequency of arrests vs Hour in Day")
lines(count$Var1, count$Freq, type = "l", lwd = 2)
```
Now we will look at the Frequency of arrests over the Hours of the Day.Citations are most common around 8 am, and around 3 pm. There may be a higher proportion of citations around 8 am because of high travel due to work. We are not quite sure why another peak is found at 3 pm, it may be people returning from school and/or work. We also see less citations during the super late/super early hours –  likely due to less travel as a whole.

```{r Scatter plot longitude vs latitude, color by district}
# Verifying the hubs for arrest and locations of districts
# Virginia
mini_htx2 <- mini_htx
mini_htx2$district <- factor(mini_htx2$district)

plot(mini_htx2$lat, mini_htx2$lng, col = mini_htx2$district, panel.first = grid(8,8),  xlim = c(29.5, 30), ylim = c(-96, -95), main = "Latitude & Longitude of Stops by District", xlab = "Latitude", ylab = "Longitude", pch=20)
legend("bottomright", legend=levels(mini_htx2$district), cex = 0.62, pch=20, col=unique(mini_htx2$district), title = "District")
```



```{r scatter plot of difference between speed and posted speed over time }
# if we want to do a line plot
# Virginia
mini_htx2$diff <- (mini_htx2$speed - mini_htx2$posted_speed)
diff <- mini_htx2$diff


plot(mini_htx2$date, mini_htx2$diff, main = "MPH over Limit for Speeding Citations 2014-2020", xlab = "Year", ylab = "MPH Speeding", pch = 4, panel.first = grid(10,10),
     col = ifelse((diff <= 5), "green", 
                    ifelse((diff <= 10), "blue", 
                           ifelse((diff <= 15), "purple","red"))))
legend("topleft", legend = c("0-5 mph", "6-10 mph", "11-15 mph", ">15 mph"), col = c("green", "blue", "purple", "red"), pch = 4, cex = 0.7)
```

```{r Citations by time of day histogram}
# x axis is the time of day
# y is frequency
# Grace

```